<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:wb="http://open.weibo.com/wb" xml:lang="en" lang="en">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
    <link rel="shortcut icon" href="http://bobao.360.cn/favicon.ico?v=1.1"/>
    <link rel="alternate" title="安全资讯" href="/rss?type=news" type="application/rss+xml"/>
    <link rel="alternate" title="安全知识" href="/rss?type=learning" type="application/rss+xml"/>
    <link rel="alternate" title="安全圈活动" href="/rss?type=activity" type="application/rss+xml"/>
    <link rel="alternate" title="所有漏洞" href="/rss?type=vul" type="application/rss+xml"/>
    <link rel="alternate" title="通用型漏洞" href="/rss?type=commonvul" type="application/rss+xml"/>
    <link rel="alternate" title="事件型漏洞" href="/rss?type=eventvul" type="application/rss+xml"/>
    <link rel="alternate" title="热门漏洞" href="/rss?type=hotvul" type="application/rss+xml"/>

        <title>【技术分享】 企业无线安全解决方案——分析无线攻击行为与制定防御规则安全策略 - 安全客 - 有思想的安全新媒体</title>
    
        <meta name="keywords" content="WIPS,企业无线安全解决方案,无线安全,无线攻击行为"/>
    
        <meta name="description" content="本文为企业无线安全解决方案第二篇文章。由于新等保将无线安全列为合规性需求，无线安全问题备受关注，因此本文就详细分析无线攻击行为与制定防御规则安全策略方法展开介绍。"/>
        <meta property="wb:webmaster" content="224437c7be31d633"/>

    <script type="text/javascript" src="http://s7.qhimg.com/!56caa871/xpc_sync_height.js"></script>
    <link rel="stylesheet" type="text/css" href="/css/reset.css" />
    <link rel="stylesheet" type="text/css" href="/css/common_new.css?v=4.4.2.1" />
    <link rel="stylesheet" type="text/css" href="/css/jquery.notyfy.css" />
    <link rel="stylesheet" type="text/css" href="/css/notyfy.theme.default.css" />
    <link rel="stylesheet" type="text/css" href="/css/s_common.css?v=2.2.7" media="only screen and
    (max-device-width:900px), only screen and (max-width:900px)" />
    <script type="text/javascript" src="/js/jquery.min.js?v=3.1"></script>
    <script type="text/javascript" src="/js/jquery.notyfy.js"></script>
    <script type="text/javascript" src="/js/iscroll.js"></script>
    <script src="http://js.passport.qihucdn.com/5.0.3.js"></script>
    <script type="text/javascript">
        var myScroll, myNavScroll;

        function iscrollLoaded() {
            myScroll = new IScroll('#wrapper',
                {
                    scrollX: true,
                    scrollY: false,
                    bounceEasing: 'circular',
                    eventPassthrough: true,
                    preventDefault: false,
                    bounceTime: 500
                }
            );
        }

        $(function () {

            //导航横向滚动


            function setNavWidth() {

                /* 计算导航宽度 */
                var allWidth = $(window).width();
                var scroller = $('#scroller');

                if (allWidth > 900) {
                    scroller.find('ul').add(scroller.find('.scroll')).removeAttr('style');
                    scroller.css('overflow', 'visible');
                    if (myNavScroll) myNavScroll.destroy();
                } else {

                    var width = 0;
                    scroller.find('.scroll').children('ul').children('li').each(function (index, el) {
                        if (!$(this).hasClass('mobile-hide')) {
                            width += $(this).outerWidth();
                        }
                    });
                    scroller.find('ul').add(scroller.find('.scroll')).width(width);

                    if (myNavScroll) myNavScroll.destroy();

                    myNavScroll = new IScroll('#scroller', {
                        scrollX: true,
                        scrollY: false,
                        momentum: false,
                        click: true
                    });

                }

            }

            setNavWidth();
            $(window).resize(function (event) {
                setNavWidth();
            });

        });

    </script>
</head>
<body onload="iscrollLoaded();">
<div style='margin:0 auto;width:0px;height:0px;overflow:hidden;'>
    <img src=""/>
</div>

<div id="is-mobile"></div>
<div class="container">
        <div class="mobile-header">
        <div class="header clearfix">
            <div class="header-wrapper clearfix">
                <a href="/index/index" class="logo"><img class="slogan" src="/img/logo.png?v=1.5"/></a>
                                <form id="search" class="search-box" action="/search/index" method="GET">
                    <input class="keys" name="keywords" type="text" placeholder="搜索漏洞" required="required">
                    <input class="icon" type="submit" value="">
                    <input type="hidden" name="type" value=""/>
                </form>
                <div class="bug">
                    <div class="name"><span class="seled">全部</span><i class="arrow"></i></div>
                    <ul class="typelist">
                        <li data-index="3"><a href="javascript:void(0);">全部</a></li>
                        <li data-index="0"><a href="javascript:void(0);">漏洞</a></li>
                        <li data-index="1"><a href="javascript:void(0);">资讯</a></li>
                        <li data-index="2"><a href="javascript:void(0);">知识</a></li>
                    </ul>
                </div>
                                <div class="logNreg mobile-hide">
                    <div class="unlog">
                        <i></i>
                        <a href="log.html" class="log">登录</a>
                        <span>|</span>
                        <a href="reg.html" class="reg">注册</a>
                    </div>
                    <div class="loged">
                        <a href="/member/profile" class="user-center"><i></i><span class="user-name-tag">个人中心</span></a>
                        <div class="user-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting"><a href="http://i.360.cn/profile/accountmanage"
                                                               target="_blank"><i></i><span>账号设置</span></a></li>
                                <li class="alert-setting"><a href="/keywords/index"
                                                             target="_blank"><i></i><span>告警设置</span></a></li>
                                <li class="bug-alert"><a href="/myalarm/index" target="_blank"><i></i><span>漏洞告警</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mylearn/index" target="_blank"><i></i><span>我的知识</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mycourse/index" target="_blank"><i></i><span>我的课堂</span></a>
                                </li>
                                <li class="my-exit"><a
                                            href="http://login.360.cn/?src=pcw_adlab&op=logout&destUrl=http://bobao.360.cn"><i></i><span>退出系统</span></a>
                                </li>
                            </ul>
                        </div>

                        <a href="/message" class="message-center" target="_blank"><i></i><span>我的消息</span></a>
                        <div class="message-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting" style="display:none;"><a href="/myres/index"
                                                                                     target="_blank"><i></i><span>回复我的</span></a>
                                </li>
                                <li class="my-bug"><a href="/myvul/index"
                                                      target="_blank"><i></i><span>我的漏洞</span></a></li>
                                <!--<li class="my-bug"><a href="/myres/index" target="_blank"><i></i><span>我的评论</span></a></li>-->
                                <!--<li class="alert-setting"><a href="###" target="_blank"><i></i><span>提到我的</span></a>
                                </li>-->
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <style type="text/css">
            .nav {
                overflow: hidden;
            }

            .nav .scroll {
                width: auto;
            }
        </style>
        <div id="wrapper">
            <div id="scroller" class="nav">
                <div class="scroll">
                    <ul class="nav-list">
                        <li ><a class="link-nav"
                                                                                 href="/index/index">首页</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/vul/index">漏洞</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/introduce/list">招聘</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/news/index">资讯</a><!--<i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/introduce/list">招聘</a></li>
                        </ul>
			-->
                        </li>
                        <li class="cur">
                        <a class="link-nav" href="/learning/index">知识</a><i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/course/index">学院</a></li>
                        </ul>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/activity/index">活动</a></li>
                        <li class="mobile-hide "><a class="link-nav"
                                                                                                   href="/ctf/index">CTF训练营</a>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/interref/list">安全内参</a></li>
                        <li ><a class="link-nav" href="/app/index">APP</a></li>

                        <!--<li ><a href="/course/index">学院</a></li>-->
                        <!--<li ><a href="/introduce/list">招聘</a></li>-->
                        <!--<li  class="mobile-hide"><a href="/ctf/index">CTF训练营</a></li>-->
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <div class="mobile-content">
        <link rel="stylesheet" type="text/css" href="/css/news.css?v=3.5" />
<link rel="stylesheet" type="text/css" href="/ue/SyntaxHighlighter/shCoreDefault.css?v=1.0" />
<style>
    p .syntaxhighlighter {
        width: 80%;
    }
</style>

<div class="cur-pos w1000">当前位置：<a href="http://bobao.360.cn/">安全客</a> &gt;&gt; 知识详情</div>

<div class="content clearfix">
    <div class="main">
        <div class="article">
            <div id="article_box">
                <h2>【技术分享】 企业无线安全解决方案——分析无线攻击行为与制定防御规则安全策略</h2>
                <div class="article-msg">
                    <span class="time">2017-03-17 10:01:44</span>
                    
                                        <span class="read">阅读：19310次</span>
                    <span><a style="display: none;" class="good" href="javascript:;"
                             data-target="/learning/good" data-value="g_3613"
                             data-type="learning">点赞(0)</a></span>
                    <span><a class="fav" href="javascript:;" data-target="/mylearning/add"
                             data-pk="3613" data-type="learning">收藏</a></span>
                                        <span><a style="margin-left: 4px;" class="fav" href=""
                             target="_blank">来源： 安全客</a></span>
                    
                    
                    <div style="margin-top:10px; ">
                        <a href="/member/contribute?uid=775238387" style="color:#848e99;">
                            <img src="http://p1.qhmsg.com/dm/150_150_100/t01dab5be797e60cce8.jpg" data-is-avatar="true"
                                 style="border: 1px solid #d5d5d5;padding: 2px; width: 80px;height: 80px;border-radius: 43px;"/>
                        </a>

                    </div>
                    <span class="orig">作者：<a href="/member/contribute?uid=775238387" style="color:#848e99;">icecolor</a></span>
                                    </div>
                <hr size="1">
                <div class="article-msg">
                    <p><!-- JiaThis Button BEGIN -->

<!--
<span class="jiathis_style"><span class="jiathis_txt">分享到：</span>
	<a class="jiathis_button_weixin"></a>
	<a class="jiathis_button_tsina"></a>
    <a class="jiathis_button_tqq"></a>
    <a class="jiathis_button_qzone"></a>
    <a class="jiathis_button_renren"></a>
    <a class="jiathis_button_xiaoyou"></a>
    <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
</span>

-->
</p>
                </div>
                <p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></strong></span></p><p style="text-indent: 0em; text-align: center;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 18px;"><img src="http://p1.qhimg.com/t0164fbfaf9bf7c999d.jpg" title="t0164fbfaf9bf7c999d.jpg" alt="http://p1.qhimg.com/t0164fbfaf9bf7c999d.jpg"/></span></strong></span></p><p style="text-indent: 2em;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 18px;"></span></strong></span></p><p style="margin: 0px 25px 8px; padding: 0px; line-height: 25px; color: rgb(70, 79, 85); word-break: break-all; font-family: Helvetica, &#39;Hiragino Sans GB&#39;, &#39;Microsoft Yahei&#39;, 微软雅黑, serif; white-space: normal; text-indent: 2em; background-color: rgb(255, 255, 255);"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(0, 112, 192); font-size: 18px;"><span style="font-weight: 900;">作者：</span></span><a href="http://bobao.360.cn/member/contribute?uid=775238387" target="_blank" textvalue="icecolors" style="text-decoration: none; color: rgb(51, 51, 51); line-height: 28px;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 18px; color: rgb(0, 112, 192);"><span style="font-weight: 900;">icecolor</span></span></a></p><p style="margin: 0px 25px 8px; padding: 0px; line-height: 25px; color: rgb(70, 79, 85); word-break: break-all; font-family: Helvetica, &#39;Hiragino Sans GB&#39;, &#39;Microsoft Yahei&#39;, 微软雅黑, serif; white-space: normal; text-indent: 2em; background-color: rgb(255, 255, 255);"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(0, 112, 192); font-size: 18px;"><span style="font-weight: 900;">稿费：600RMB（不服你也来投稿啊！）</span></span></p><p style="margin: 0px 25px 8px; padding: 0px; line-height: 25px; color: rgb(70, 79, 85); word-break: break-all; font-family: Helvetica, &#39;Hiragino Sans GB&#39;, &#39;Microsoft Yahei&#39;, 微软雅黑, serif; white-space: normal; text-indent: 2em; background-color: rgb(255, 255, 255);"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(0, 112, 192); font-size: 18px;"><span style="font-weight: 900;">投稿方式：发送邮件至linwei#360.cn，或登陆网页版在线投稿</span></span></p><p style="text-indent: 2em;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 18px;"><br/></span></strong></span></p><p style="text-indent: 2em;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 18px;">传送门</span></strong></span><br/></p><hr/><p style="text-indent: 2em;"><a href="http://bobao.360.cn/learning/detail/3150.html" target="_self" style="text-indent: 2em; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 18px; color: rgb(0, 112, 192); text-decoration: none;"><strong>【技术分享】基于检测防御企业无线安全威胁的WIPS设计</strong></a></p><p style="text-indent: 2em;"><br/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">前言</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">之前发了个WIPS设计，写的不太好，不太清楚。前些日子听说新等保将无线安全列为合规性需求。那就来一发详细的吧。我之前写的那个包含了关于WIPS的介绍：<a href="http://bobao.360.cn/learning/detail/3150.html" _src="http://bobao.360.cn/learning/detail/3150.html">http://bobao.360.cn/learning/detail/3150.html</a>&nbsp;可以把上一篇当作是一个入门。重复的我就不提了，想了解的大家可以参照上一篇。其实感觉WIPS以后的作用点会高起来，例如在军队、政府、公司、机场、酒店、城市、学校、等等人员密集的地方都可以。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">传感器</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">传感器（Sensor）是WIPS很重要的一部分。它起到一个监控扫描并执行的作用。</span></p><p style="text-align:center"><img src="http://p6.qhimg.com/t01d996080b1f02201f.png" title="t014778fb6eee3f24e2.png" alt="http://p3.qhimg.com/t014778fb6eee3f24e2.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">真正看过传感器的人应该挺少的，我找了个，大家随意感受下：</span></p><p style="text-align:center"><img src="http://p2.qhimg.com/t01105a0e60ade9ba9f.jpg" title="t0160bb5ad79e91880e.jpg" alt="http://p7.qhimg.com/t0160bb5ad79e91880e.jpg"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">其实就长这德行，跟个路由器差不多，当然，你可以做成帅点的。传感器的布局呢，要根据你传感器信号有效距离和防护区域而部署。用OepnWrt自己就可以搞一个简单的模型试试，或者是公司自己有硬件工程师物联网工程师的可以自己搞个特制的。需要注意的就是：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">1一个传感器要支持802.11的主流协议如g/n/a</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">2要支持2.4 GHz频段和 5 GHz频段</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">3然后支持跳频扫描。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">5最好弄的结实点，不管室内还是室外。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">6你也可以弄支持多一点的功能，例如支持下其他无线协议。或者是能识别到伪基站、无人机、RF干扰什么之类的。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">这篇主要讨论检测规则和识别策略，传感器怎么搞大家自己定吧。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">开源WIDS</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;"></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">Snort大家应该都挺熟悉，一个轻量级的开源IDS。其实在里面它也扩展了无线模块，只不过很少人用而已，一般的企业简单点的话，都将Snort+Kismet作为无线告警系统的首选。不过这仅仅也就是起到告警作用。而且现在感觉已经过时了。毕竟IDS和IPS区别还是挺大的。</span><br/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Snorby（Loganalyzer Console、BASE Console）+Snort+Barnyard2。当然了，前端控制台那个漂亮用那个。看一张Snort运行的界面。这是国外的人搞的一个，没有搞到OpenWrt上，也没有用Kismet。估计就是个测试。不过Snorby的前端我挺喜欢，开源IDS多了，大同小异吧，没啥新鲜的。</span></p><p style="text-align:center"><img src="http://p3.qhimg.com/t0150967cd3adf2f66f.jpg" title="t01a4f5d829958b7646.jpg" alt="http://p8.qhimg.com/t01a4f5d829958b7646.jpg"/></p><p style="text-align:center"><img src="http://p3.qhimg.com/t01beb906f09a9ed73f.jpg" title="t01db636e8c55cf1581.jpg" alt="http://p5.qhimg.com/t01db636e8c55cf1581.jpg"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">其实也没啥，感觉Snort在无线防御方面研究也就做个入门用，这里就不写搭建过程了，有想研究的可以私下交流下，我的Q：2191995916</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">简单扯一下，关于Kismet，很多人都以为它是个扫描工具，其实它是一个802.11数据包捕获和协议分析的框架，最NB的是你可以用Kismet生成KML文件，然后在“Google Earth”上读取，就可以读取GPS数据，并且还可以通过“GISKismet”进行可视化。</span></p><p style="text-align:center"><img src="http://p8.qhimg.com/t01dbdd3da93e3873b6.png" title="t013127a65070bd9d64.png" alt="http://p0.qhimg.com/t013127a65070bd9d64.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br/></span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">De-Authentication Flood 攻击行为分析</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">Deauth是一种身份验证洪水攻击，是无线网络的拒绝服务攻击。当Client与AP建立连接时，通过广播插入伪造的取消身份验证报文，Client认为报文来自AP，然后断开连接。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">该方法不仅仅可以把AP打掉造成无限重连，而且在针对于WPA-WPA2/企业Radius+WPA架构中达到抓取Hash进行离线破解攻击。还有就是配合Fake AP进行攻击，达到更深一层的破坏。</span></p><p style="text-align:center"><img src="http://p0.qhimg.com/t0121c020e04a577dc7.png" title="t014c83d1e8d8c57a9e.png" alt="http://p0.qhimg.com/t014c83d1e8d8c57a9e.png"/></p><p style="text-align:center"><img src="http://p3.qhimg.com/t01c8b0d63c4d1b8dc9.png" title="t0171881377f441ef31.png" alt="http://p3.qhimg.com/t0171881377f441ef31.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">这是在MDK3下面做的一个测试，可以看出大量的Deauth报文。</span></p><p style="text-align:center"><img src="http://p8.qhimg.com/t01b4371508dae203d1.png" title="t0165c9c9f4b2c7e53c.png" alt="http://p7.qhimg.com/t0165c9c9f4b2c7e53c.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">遭受Deauth攻击的无线网络。</span></p><p style="text-align:center"><img src="http://p7.qhimg.com/t010d3c2d1eef52428b.png" title="t01bde51e35ddcaa8b3.png" alt="http://p8.qhimg.com/t01bde51e35ddcaa8b3.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">在Wireshark的Filter中进行针对Deauth Frame进行过滤：</span></p><pre class="brush:plain;toolbar:false">“wlan.fc.type&nbsp;==0&nbsp;&amp;&amp;&nbsp;wlan.fc.type_subtype&nbsp;==0x0c”</pre><p style="text-align:center"><img src="http://p6.qhimg.com/t01baa107367e7201bf.png" title="t01a7633ac0f4f0f009.png" alt="http://p3.qhimg.com/t01a7633ac0f4f0f009.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Reason Code 是Deauth Frame中的一个原因代码。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">根据802.11给的 Reaon Code一段代码表：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><a href="https://supportforums.cisco.com/document/141136/80211-association-status-80211-deauth-reason-codes" _src="https://supportforums.cisco.com/document/141136/80211-association-status-80211-deauth-reason-codes">https://supportforums.cisco.com/document/141136/80211-association-status-80211-deauth-reason-codes</a>&nbsp;</span></p><p style="text-align:center"><img src="http://p8.qhimg.com/t016010489cb9e53da8.png" title="t01cc6c463df871858a.png" alt="http://p0.qhimg.com/t01cc6c463df871858a.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">可知，上述原因（0X0001）是由于未知情况造成的。所以间接可以排除掉其他“正常”状态下的断开连接，缩小排查范围。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">其实DOS攻击还有很多种，例如什么ASSOC Attack，Auth Attack，针对802.1x的EAPOL</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">下面就是个Auth Attack与EAPOL Attack的报文：</span></p><p style="text-align:center"><img src="http://p8.qhimg.com/t019410b001938f1674.png" title="t01ad96c03b0dc22917.png" alt="http://p9.qhimg.com/t01ad96c03b0dc22917.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Auth Flood攻击</span></p><p style="text-align:center"><img src="http://p6.qhimg.com/t0153a9b685c8250727.png" title="t011e1bea4860fac385.png" alt="http://p9.qhimg.com/t011e1bea4860fac385.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">EAPOL Flood 攻击</span></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br/></span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">De-Authentication 策略规则检测方法</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">&nbsp;主流的攻击呢就一个Deauth，但是不只是这一个，真正去做无线防御的时候所有的DOS攻击方式都要进行规则检测，因为攻击者者可能都会用到，这里就举这一例。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">在WiFi Deauth DoS攻击检测的典型的方法是在网络流量监控和调用一个阈值为deauth帧数量的观察。如果观察到的数据包的数目是在此阈值以上，然后生成警报。在许多情况下，这个阈值是由人们的经验，选一个最佳流量值。这个值通常由正常帧的发送基准进行设定。超过这个级别的任何值被归类为异常。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">&nbsp;802.11协议 是一个二层网络协议，无线协议只定义了 OSI 架构中物理层和数据链路层（MAC 子层）两层的内容， 其它层的内容和有线网络是一样的。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">1层攻击不好识别，2层攻击可以通过监测帧来识别。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">所以说，我们只要检测帧控件内容，对每个802.11帧、帧控件包含的Type、Subtype、 Management Type，包括Beacon、Disassociation、Deauth Subtypes，和这些CTS和RTS类型。将使用这些类型和子类型来过滤帧。检测需要过滤的类型与子类型为：</span></p><p style="text-align:center"><img src="http://p8.qhimg.com/t01d383bb9f3ec98401.png" title="t0114259963cc410d98.png" alt="http://p4.qhimg.com/t0114259963cc410d98.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 18px;"></span></p><pre class="brush:plain;toolbar:false">“&nbsp;Management&nbsp;Frames&nbsp;(wlan.fc.type&nbsp;eq&nbsp;0)”
“Deauthentication&nbsp;(wlan.fc.type_subtype&nbsp;eq&nbsp;12)”</pre><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">其实这个脚本倒是很好搞，原理不很难。最难的是对于阈值的判断，因为阈值的设定关系到了检测的精准度。Deauth攻击的误报是很烦的。阈值设定跟好多因素有关，例如你的AP部署环境、客户端、架构等等小细节有关。所以说我有个想法就是将阈值根据部署前的环境进行检测，然后设置成动态的。这是我在家里自己测试的Deauth 攻击检测算法。识别还是挺快的，但是偶尔也有点小问题，正在修正。但我的环境有限，在家里终跟企业环境不一样。企业又跟城市不一样，以后有了大环境可以实验的时候我在搞搞别的。</span></p><p style="text-align:center"><img src="http://p1.qhimg.com/t011b53eb974cdb1ed3.png" title="t01a5b1db875c798b74.png" alt="http://p6.qhimg.com/t01a5b1db875c798b74.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">（我之前提供过一个老外的脚本，非常抱歉当时没测试，只是眼看了下判断过程就贴了，那个脚本有点问题，我自己正在搞一些严密点的检测规则，以后可能会发出来。）</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">其实IEEE的工程师解决过这个问题，就是搞了一个叫做 802,11W，加密auth握手过程，协议思路是从判Deauth是AP还是攻击者来做的，所以搞了802.11wAP过来的管理帧都是加密的攻击者不知道加密，所以发过来节点都不认。但是这个802.11W要求条件需要客户端AP都支持，并且兼容性不好，一直没啥人注意。在WIN8和8.1是强制开启的应该。不过看样子是跟着WIN8一起死掉了。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">之前我脑洞大开还想了个能不能根据AP重连的时间设定阈值，后来翻看协议指南发现与信道竞争有关，这个不是一个绝对值，用户数的多少会影响重连时间。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">所以说，我也试图曾经增加条件来识别Deauth，但是增加条件或许可以减少误报，但是会影响识别率。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">其实针对Deauth的话，除了Flood攻击让人头疼之外，还有就是针对HASH和HandShake的攻击。因为攻击者会使用Deauth对AP和Client进行数据包窃取。这个攻击其实是防不掉的。抓到握手包的条件跟 Ap信号的好坏，和所在AP客户端的多少是有关系的。也就是说只要是条件好，Deauth攻击可以瞬间拿到握手包。也就是说你的识别策略就算是精确到百分百也会比它慢。就算是识别阻断掉了危险AP，你的Handshak还是已经被人拿了。不过，我想过一个策略就是：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">“当WIPS识别到Deauth攻击时，切断AP后，立刻向控制台进行告警，控制台通知该用户立刻修改密码。将源MAC加入黑名单并记录。（虽然可能是伪造，但是也要进行取证）并且将Calient MAC地址暂时存入黑名单，防止攻击者修改MAC地址趁设备掉线加入其内网。WIPS应该配备密码检测工具来检测员工密码的强弱。”</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t01fe514824954a22bc.png" title="t011dc014ed39eb9aee.png" alt="http://p8.qhimg.com/t011dc014ed39eb9aee.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Fake AP攻击行为分析</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;"></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">其实伪AP是在Wlan中最直接，也是最致命，最普及的一种攻击。原理也很简单，攻击者自己建立一个“Hack AP”然后用DOS攻击强制你与合法AP断连并连接到“Hack AP”从而窃取你的帐号密码，以及各种隐私。</span><br/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">针对非企业Radius架构下的攻击原理示意图：</span></p><p style="text-align:center"><img src="http://p8.qhimg.com/t019d9628ea17f2f439.png" title="t011fd8568dfc964023.png" alt="http://p1.qhimg.com/t011fd8568dfc964023.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">我之前用Easy-Creds做过一次。当然了，这种脚本有好多，不一一列举了，看下攻击效果。</span></p><p style="text-align:center"><img src="http://p0.qhimg.com/t01e201c11489d2978b.png" title="t0165c36ffe7cc6c819.png" alt="http://p8.qhimg.com/t0165c36ffe7cc6c819.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">劫持帐号密码</span></p><p style="text-align:center"><img src="http://p6.qhimg.com/t016a529383afe9512e.png" title="t0191852d54658a2f5d.png" alt="http://p4.qhimg.com/t0191852d54658a2f5d.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">劫持流量图片</span></p><p style="text-align:center"><img src="http://p5.qhimg.com/t014cdadb5184edc3cf.png" title="t010c829818aa37c40c.png" alt="http://p6.qhimg.com/t010c829818aa37c40c.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">这是一个比较直观的效果了。之前发生过许多银行卡被盗，密码被窃取，都是在不安全的环境下连上或者是被动连上了不合法的AP。其实Rogue AP与Fake AP类似，只不过是一个主动一个被动罢了。前者是遍地撒网，后者是较有针对性。这种办法在学校，或者酒店，机场。屡试不爽！（别问我怎么知道）如果在企业这样被搞了，那基本也就GG了。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">针对企业Radius架构的攻击原理示意图：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">针对WPA-Enterprise作为无线部署方案的攻击。以前写过一个，基于EAP协议的东西还是挺多的。http://cb.drops.wiki/drops/wireless-16971.html这是之前写过的一个专门针对于企业无线渗透的paper。里面有涉及Radius和一些基于EAP的认证方式和安全研究。可以参照下。</span></p><p style="text-align:center"><img src="http://p8.qhimg.com/t01179cdae66048a26f.png" title="t01fbca35338ba4f903.png" alt="http://p0.qhimg.com/t01fbca35338ba4f903.png"/></p><p style="text-align:center"><img src="http://p3.qhimg.com/t01a524364b8e2f6c71.png" title="t0103c70a86635f6b4e.png" alt="http://p6.qhimg.com/t0103c70a86635f6b4e.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Hostapd-wpe是Freeradius-wpe的升级版，都内置了Radius程序。因为服务器和客户端很少有部署证书的情况，所以根本阻挡不了这种攻击。</span></p><p style="text-align:center"><img src="http://p6.qhimg.com/t017f4a0f9aba5665f3.png" title="t015e9cb0c734e19028.png" alt="http://p9.qhimg.com/t015e9cb0c734e19028.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Fake AP 策略规则检测方法</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">忘记之前在那看见过了，有一篇文章专门讲的是针对于伪AP的研究。今天我就来用实际分析来解释一下这些理论。</span></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">通过时钟偏差检测</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">IEEE802.11协议中有个TSF，。FakeAP通常会伪造正常AP的timestamp 。所以它与授权的AP几乎相同的时钟偏差。但是当信标帧被再次重建时，在帧的形成和其重传期间注入几微秒的延迟。这将产生具有不同序列号的重复帧，所以以检测到AP是伪造的。捕获信标帧，记录时间戳，计算时钟偏移量。然后用LSF给它确定一个阈值。用LSF的原因是更加精确。其实对于这种检测手段怎么搞的都有，之前看到过一篇报告，说是正常的AP时间戳会递增。而不正常的AP会有夸大变化，其实跟上面这个也差不多一个意思。其实可以理解成你的夸张不可以超过我给你的极限值。</span></p><p style="text-align:center"><img src="http://p7.qhimg.com/t010b641618fcf94f6b.png" title="t01e6f55f29de3f9925.png" alt="http://p4.qhimg.com/t01e6f55f29de3f9925.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">这个是我设置的一个fake AP 和正常AP，同SSID：Security 同MAC：C8:XX:XX:XX:XX</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">这是相邻的两个数据包：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><pre class="brush:plain;toolbar:false">Timestamp&nbsp;0x0000000001a5e271&nbsp;&nbsp;&nbsp;15271&nbsp;&nbsp;
Timestamp&nbsp;0x00000000c110b249&nbsp;&nbsp;&nbsp;110249</pre><p style="text-align:center"><img src="http://p5.qhimg.com/t016f83b8563dea6e09.png" title="t013c3f76db7a5dedd1.png" alt="http://p7.qhimg.com/t013c3f76db7a5dedd1.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><pre class="brush:plain;toolbar:false">Timestamp:0x000000000245bd3b7&nbsp;&nbsp;24357
Timestamp:0x000000000f6e183&nbsp;&nbsp;&nbsp;&nbsp;6183</pre><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">其实经过好多次的测试呢，也不知道是正好碰上还是怎么，有几次fake AP并不是按照逻辑增长，有时也会小。所以说这方面还是要好好研究下的。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">PS：Timestamp的单位是：us</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">其实我最开始搞的时候，先搭建一个真AP的环境。之后收集真AP的Beacon，计算Beacon之间Timestamp的差值，记为一个“D-value”，之后在去扫描全网环境，包含真伪AP的数据Beacon，逐步计算差值后也记为一个“D-value-1”然后这两个值去比较，最后取一个TSV值。这里告诉大家一个技巧吧，就是你不要去收集单独Fake AP之间的Beacon Timestamp，因为经过我之前的测试他们的差值很夸张，根本不准确，反而影响检测算法，前面已经说过了Fake AP的逻辑不走寻常路。</span></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">基于时序特性</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">基于时序特性的检测方法实际上就是通过检测两个顺序帧的接收时间间隔，即帧间到达时间来进行伪AP识别的，beacon和SSID（或者ESSID），识别同一个AP的beacon，按照协议设置，一般这个时间为TBTT，默认值为100ms，实际会有上下浮动 但是如果仅仅是几ms间隔就有一个新的beacon，那么就是有问题的了。其实在Beacon间隔是可以认为设定的，上述情况是说除在认为情况下，并且单AP的时候还可以用这个办法，多AP漫游的话就要查BSSID。</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t01220a23121d7b4e62.png" title="t01ffc03ff61e3d61ce.png" alt="http://p4.qhimg.com/t01ffc03ff61e3d61ce.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">还有个是根据PLL来识别的，说是可以更精确，其实还是那句话，规则多了，精确度就高了，但是精确度越高越容易出现误报。针对咱们实际环境来说，上面的任意一条都可以了。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">在检测规则方面，我们可以事先设定好除了算法之外的规则，例如规则中你要加入除白名单内的SSID，MAC，加密信息之外的相同信息AP都要列入阻断名单。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">检测流程图大致为：</span></p><p style="text-align:center"><img src="http://p1.qhimg.com/t011103d775d7782561.png" title="t01515ce100fcdc7b59.png" alt="http://p0.qhimg.com/t01515ce100fcdc7b59.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">这是我自己想的一个检测手法，流程比较简单，但是感觉还算挺实用。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">其实之前还有有人提到过一个概念也用在了无线Fake AP检测上，方法跟黑白名单差不多，只不过从某种方面来说更准确了一些。是用了一个叫做（Off-by-one）的现象。翻译过来叫做“大小差1”。因为根据厂商的不同，有的厂商在做硬件的时候，一个硬件必须配一个MAC地址，如果一个设备上有多个接口，那么他们的MAC地址会相关，也就是说前5个字节都是相同的，但是最后一位会在数值上差1。这个可以在iphone上得证：</span></p><p style="text-align:center"><img src="http://p0.qhimg.com/t01db2d6f3c2a867bed.png" title="t01cc1105d9f1271433.png" alt="http://p7.qhimg.com/t01cc1105d9f1271433.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">家里这手机是旧的，不知道新的Iphone还遵循没遵循这个。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">蓝牙接口的MAC 为：0C:77:1A:54:D6:08</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">因为这两个是无线接口，并且在同一设备，所以出现了这种情况。一般来说，路由器会有这种情况。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">检测算法就是，当扫描出一个设备，出现“大小差1”情况时，并识别到这个设备本地联网又无线上网的时候，可以认为它就是一个AP接入点。立刻查看这个设备的信息是否在</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">白名单里，如果不在，立刻阻断它。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">下面是个检测Fake AP的示意图：</span></p><p style="text-align:center"><img src="http://p1.qhimg.com/t01331f4cbef356d239.png" title="t01907ee28f47d1ba10.png" alt="http://p3.qhimg.com/t01907ee28f47d1ba10.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br/></span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Rogue AP 攻击行为分析</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">&nbsp;其实Rogue AP的面很广，不单单是有危险的AP接入点。我觉得员工私建热点也属于Rogue AP的一种，同样影响着办公网的安全。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">其实最可以准确举例Rogue AP的例子，就是大家耳熟能详的“Sheep Wall”</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t010289754c64b99636.jpg" title="t01f85a027225a399d9.jpg" alt="http://p5.qhimg.com/t01f85a027225a399d9.jpg"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">除此之外呢，例如会起一些较为诱惑的AP名字，例如：“Freewifi、CMCC、Hotel”等等等..,,</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">之前在上海机场候机，机场内有个覆盖型WIFI名为：“ishanghai”我感觉我直接起个fake AP 为：“lshanghai”就可以钓到好多。</span></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br/></span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Rogue AP策略规则检测方法</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Rogue AP的检测呢，你也可以用上面的办法，不过就是修改几条规则的问题也可以建立一个白名单 &nbsp;把你公司合法AP都列入这个白名单里面。其余扫描到的都是不合法AP和未知AP，其中最关键的就是AP是否加密。</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t01993514fa409cc59d.png" title="t0116f6f18dfe6281eb.png" alt="http://p8.qhimg.com/t0116f6f18dfe6281eb.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">未加密的“AP”</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">这是第一种方法。 第二种方法，就是进行内检，去扫描被隐藏了ssid的AP。 &nbsp;这也可能是员工自建的AP。基于这两种规则。自建AP被黑基本也GG，但一般人自建之后都会隐藏SSID</span></p><p style="text-align:center"><img src="http://p8.qhimg.com/t0148c37f44ed088056.png" title="t0100f438c4b56c0f65.png" alt="http://p2.qhimg.com/t0100f438c4b56c0f65.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">发现隐藏SSID直接MDK3+kismet</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">其实我曾经想过也可以针对Rogue的SSID做一些小规则，例如提供一些关键字：“公司为Google的话，除了白名单内出现的带“Google 各种大小写，各种类似Google的关键字”之外的AP，都将被列入警告，然后让管理员排查。</span></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br/></span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">关于MAC地址欺骗的检测研究<span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">&nbsp;在无线准入规则里面MAC地址的过滤一定会出现，但是MAC地址是可以随意修改的，就算你的AP接入点设置仅允许白名单的MAC地址与AP相连。我也可以黑掉你的真实客户端，然后改成你的MAC地址连入公司网络（当然，这是在被WIPS绕过的前提下）。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">办法我也看了一些，也没什么太好的，只能客观一点。最外层就是WIPS不要被打破。而且还有可以从连接AP的客户端中进行排查。例如此MAC地址之前连接的设备一直为“APPle，之后突然变成了Android或者其他设备”这时就要注意一些了。</span></p><p style="text-align:center"><img src="http://p6.qhimg.com/t01ed077d29fc27a390.png" title="t01534d603480b1b9b9.png" alt="http://p7.qhimg.com/t01534d603480b1b9b9.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">检测无线连接设备</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">其实在WIPS，无线监控也很重要，例如监控每个AP连接的客户点，甚至包括客户端的设备类型。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">其实以上检测规则不一定是在WIPS中，一些手机安全软件也是带有检测危险AP功能。</span></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br/></span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">无线其他威胁应对策略</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><strong style="text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">802.1 Fuzzing：</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">802.11 Fuzzing是一种恶意的攻击，可能对受害设备造成重大损害。 在这些攻击中，攻击者将意外的数据注入802.11帧，并导致受害设备驱动程序/操作系统通过基于堆栈的溢出而崩溃。</span></p><p style="text-align:center"><img src="http://p8.qhimg.com/t01967af26cd37a3cae.jpg" title="t018c04b20ca0374547.jpg" alt="http://p9.qhimg.com/t018c04b20ca0374547.jpg"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">不过感觉基本没人用这个。</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">War Driving：</span></strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">所以说一般的WIPS都有自己绘制的热点地图，这也是定位必要原因。</span></p><p style="text-align:center"><img src="http://p1.qhimg.com/t0125865d4566807178.png" title="t016af231e5b04d64b5.png" alt="http://p2.qhimg.com/t016af231e5b04d64b5.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Cisco的WIPS热点图，我觉得蛮漂亮的，也不花哨</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">访客WLAN：</span></strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">其实感觉如果公司来访客的话基本上可以给WLAN进行隔离，然后权限放低。当访客走后修改密码。</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">密码安全：</span></strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">特别是对外的AP密码，切勿使用与本司相关的一切关键字，之前参加过某司的沙龙，密码是公司名+字符混合....我估计我现在去还能连上</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">最令人难受的应该是这个,尽量告诉员工别整这个....</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t019ed6d600910c1aa7.jpg" title="t011514f6b0df7692b1.jpg" alt="http://p7.qhimg.com/t011514f6b0df7692b1.jpg"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">这就不多说了。怕挨喷。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">后记</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">其实感觉无线防入侵系统和内网防入侵系统相结合是最好的。抵制一些内网渗透啊，中间人攻击什么。Vlan也该是一个关注点。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">还有就是MAC地址过滤与SSID一样，我感觉并不能算是一个安全机制.只能算个功能。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">其实别看上面思科WIPS那个图他们的防御点那么多，什么EAP ATTACK、什么ASSOC ATTACK。无非就是把我上面搞的那些东西细分化了,不同的DOS就可以分离出四五种检测是没问题。其实也不能叫噱头，确实攻击与攻击不一样，目的也不太一样。我上面搞的都是最主流最有威胁性的。然后加点中间人防御，估计我上面的东西如果运用到实际就差不多可以整出好多这样的那样检测规则。什么独创各种检测引擎。当然，不是黑思科，人家的产品放到国内还是6的飞起的。而且WIPS也需要很多辅助功能。这我就不说了。另外也可以加点什么伪基站扫描啊，运用在城市端也是不错的，反正都是无线嘛，又不单单WLAN是无线。在传感器搞一搞，也可以。本来上次发誓说去搞其他协议了不写这企业无线的了，没想到打脸了又。反正也打习惯了 。国内研究这个的还是少数几家，国内也没啥资料。我想着能填补就填补下吧，这也是算是给有这心气的企业开了个小门吧。以后会搞一些蓝牙与zigbee和其他智能家具协议安全的文章与大家交流。因为我是独立研究，很少有人交流，如果那地方你觉得错了恰巧你还懂欢迎指正，也欢迎同行交流。联系方式再写一次吧：Q:2191995916@Team网络尖刀（JDSEC）再会。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><p style="white-space: normal; text-indent: 2em;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 18px;">传送门</span></strong></span></p><hr style="white-space: normal;"/><p style="white-space: normal; text-indent: 2em;"><strong style="text-indent: 2em; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 18px; color: rgb(0, 112, 192); text-decoration: none;"><a href="http://bobao.360.cn/learning/detail/3150.html" target="_self" style="text-indent: 2em; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 18px; color: rgb(0, 112, 192); text-decoration: none;">【技术分享】基于检测防御企业无线安全威胁的WIPS设计</a></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br/></span><br/></p></p>
                <hr/>
                <p style="text-align: center;">
                    <img src="http://bobao.360.cn/img/app.jpeg"/>
                    <img src="http://bobao.360.cn/img/weixin.jpeg"/>
                </p>
                                <p>本文由 安全客 原创发布，如需转载请注明来源及本文地址。<br/>本文地址：http://bobao.360.cn/learning/detail/3613.html
                </p>
                            </div>
            <div style="margin-top: 20px;background-color:#FFFFFF">
    <input type="hidden" id="detail_title" name="detail_title" value="【技术分享】 企业无线安全解决方案——分析无线攻击行为与制定防御规则安全策略 - 安全客 - 有思想的安全新媒体" />
    <input type="hidden" id="use_nickname" name="use_nickname" value="0" />
    <a name="mao"></a>
    <div class="reg-log mobile-hiden">
        <div class="" id="userTo">   
            <div id="to-list" class="input-text" style="">
                <textarea disabled="disabled" class="hide"  id="comment-content" to="to"></textarea>
                <ul id="preadded" style="display:none">       
                </ul>
                <div id="to-auto" style="width: 200px">
                    <ul id="feed">
                    </ul>
                </div>
            </div>
        </div>
        <input type="hidden" id="source-id" value="3613" />
        <input type="hidden" id="source-type" value="learning" />
        <input type="hidden" id="post-comment-url" value="/comment/add" />
        <input type="hidden" id="post-nickname-url-ajax" value="/comment/randnicknameajax" />
        <input type="hidden" id="post-check-login-url-ajax" value="/comment/checklogin" />
        <input type="hidden" id="stoken_comment_set" value="ea3898fb4df38673fdeb61c458234054">                 <span class="join">参与讨论，请先 <a href="javascript:;" class="comment-login">登录</a> | <a href="javascript:;" class="comment-reg">注册</a> |  <a href="javascript:;" class="anonymous-comment">匿名评论</a></span>
            </div>
    <div class="mobile-hide" style="width: 870px; margin: 0 auto;">
        <label style="vertical-align:middle;" for="use_nickname">匿名</label> 
        <input style="vertical-align:middle;" id="trigger-nickname" name="use_nickname" class="use_nickname" type="checkbox" value="0" />

        <a href="javascript:;" class="apply-use button" id="submit-comment" data-target="/comment/add">发布</a>
    </div>


    <div class="clearfix"></div>
    <div class="comments">
        <div class="comments-head">
            <span class="title">用户评论</span>
        </div>
                <div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src="/img/photo/11x48x48.png">
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="775238387" class="response" data-bind-id="775238387" data-target="12483" user-name="icecolor" href="javascript:;">
                icecolor            </a>
                        <span class="comment-time">2017-03-19 18:22:52</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="775238387" data-target="12483">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_12483" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">谢谢</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
<div class="clearfix re-comment">
    <div class="comment-quote">  
        <div class="comment-user">
            <a href="javascript:;" class="response" data-bind-id="245645961" data-target="12474">twittered</a> <span class="comment-time">2017-03-18 17:32:16</span>            <div class="comment-action">                        <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="245645961" data-target="12474">回复</a></span>&nbsp;|&nbsp;                        <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_12474" data-type="comment">点赞</a></span>            </div>
            <p>帮你推荐了啊</p>
        </div>
    </div>
        </div>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>
<div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src='http://p1.qhmsg.com/dm/48_48_100/t018fc2200a809a7add.jpg'/>              
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="245645961" class="response" data-bind-id="245645961" data-target="12474" user-name="twittered" href="javascript:;">
                twittered            </a>
                        <span class="comment-time">2017-03-18 17:32:16</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="245645961" data-target="12474">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_12474" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">帮你推荐了啊</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>
<div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src="/img/photo/9x48x48.png">
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="0" class="response" data-bind-id="0" data-target="12453" user-name="陈小二_微博" href="javascript:;">
                陈小二_微博            </a>
                        <span class="comment-time">2017-03-17 11:51:00</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="0" data-target="12453">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_12453" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">//@thewayma:转发微博</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>

        <a class="more-long comment-more" href="javascript:;" data-target="/comment/more" data-type="learning" data-source-id="3613" data-page="2">查看更多</a>
            </div>
</div>
<script>
    $(function () {
        $('.anonymous-comment').click(function () {
            $(".join").hide();
            $(".reg-log textarea").first().removeAttr("disabled").show();
            $('#use_nickname').val('1');
//            $('#trigger-nickname').attr('checked', true);
            $('#trigger-nickname').trigger('click');
        });
        //为所有复选框绑定事件
//        checkbox_on_click();
        //ajax随机获取昵称
//        randnicknameajax(0);
        //ajax检测登录状态
        comment_check_login();
    });



    function input_checkbox(flag) {
        $('input:checkbox').each(function () {
            var value = flag ? 1 : 0;
            $(this).prop('checked', flag);
            $(this).val(value);
        });
    }

//ajax随机获取昵称
    function randnicknameajax(flag) {
        $.ajax({
            type: 'POST',
            url: $('#post-nickname-url-ajax').val(),
            data: {limit: 1, flag: flag},
            dataType: "json",
            success: function (data) {
                $('#nick-name').val(data.data[0]);
                _nick_name=data.data[0];
            }
        });
    }
    $();
//ajax检测登录状态
    function comment_check_login() {
        $.ajax({
            type: 'POST',
            url: $('#post-check-login-url-ajax').val(),
            data: {},
            dataType: "json",
            success: function (data) {
                if (data.success) {
                    $('.join').hide();
                    $(".reg-log textarea").first().removeAttr("disabled").show();
                    $("#span_use_nickname").show();
                    $('#use_nickname').val('0');
                    $('#use_nickname').attr('checked', false);
                }
            }
        });
    }
</script>        </div>
    </div>
    <div class="side-bar">
        <div class="mod hot-news">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-hot"></i><span>热门知识</span></h2>
    </div>
    <ul class="links-list">
                                <li><a href="/learning/detail/4411.html" alt="【漏洞预警】一个换行符引发的奥斯卡0day漏洞(CVE-2017-8759)重现——最新的Office高级威胁攻击预警" target="_blank">【漏洞预警】一个换行符引发的奥斯卡...</a></li>
                                <li><a href="/learning/detail/4416.html" alt="【漏洞预警】Microsoft .NET Framework漏洞（CVE–2017–8759）预警" target="_blank">【漏洞预警】Microsoft .NE...</a></li>
                                <li><a href="/learning/detail/4414.html" alt="【技术分享】妙用JavaScript绕过XSS过滤" target="_blank">【技术分享】妙用JavaScrip...</a></li>
                                <li><a href="/learning/detail/4418.html" alt="【技术分享】利用威胁情报数据平台拓展APT攻击线索一例" target="_blank">【技术分享】利用威胁情报数据平台拓...</a></li>
                                <li><a href="/learning/detail/4417.html" alt="【知识】9月15日 - 每日安全知识热点" target="_blank">【知识】9月15日 - 每日安全知识热...</a></li>
                                <li><a href="/learning/detail/4425.html" alt="【安全报告】XShellGhost事件技术回顾报告" target="_blank">【安全报告】XShellGhost事件...</a></li>
            </ul>
</div>        <!-- 友情链接 -->
        <div class="mod blog-links mobile-hide">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-link"></i><span>友情链接</span></h2>
        <a href="/links/index.html" class="more">更多<i></i></a>
    </div>
        <ul class="links-list">
                <li><a href="http://bbs.360safe.com" alt="360安全社区" target="_blank">360安全社区</a></li>
                <li><a href="http://zhuji.360.cn" alt="360主机卫士" target="_blank">360主机卫士</a></li>
                <li><a href="http://blogs.360.cn/" alt="奇虎360技术博客" target="_blank">奇虎360技术博客</a></li>
                <li><a href="http://wangzhan.360.cn/" alt="360网站卫士" target="_blank">360网站卫士</a></li>
                <li><a href="http://webscan.360.cn/" alt="360网站安全检测" target="_blank">360网站安全检测</a></li>
                <li><a href="http://research.360.cn/report/" alt="360研究报告" target="_blank">360研究报告</a></li>
                <li><a href="http://unicorn.360.cn/" alt="360 Unicorn Team" target="_blank">360 Unicorn Team</a></li>
                <li><a href="http://appscan.360.cn/" alt="360捉虫猎手" target="_blank">360捉虫猎手</a></li>
                <li><a href="https://threathunter.org/" alt="ThreatHunter社区" target="_blank">ThreatHunter社区</a></li>
                <li><a href="http://security.360.cn/" alt="360安全应急响应中心" target="_blank">360安全应急响应中心</a></li>
            </ul>
    </div>
        <!-- 联系我们 -->
        <div class="mod contact mobile-hide" style="text-align:center">
    <div class="head-bar clearfix">
        <h2><i></i><span>关注我们</span></h2>
    </div>
    <!-- 微信关注 -->
    <ul class="contact-way">
        <li><a>微信关注</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/qrcode_adlab_weixin.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
    <!-- APP下载 -->
    <ul class="contact-way">
        <li><a>安全播报APP</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/scan_code_big.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
</div>

    </div>
</div>

<script type="text/javascript" src="/js/jquery-ui.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/jquery.noty.packaged.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/common.js?v=4.5"></script>
<script>$(function() {sync_count('comment');});</script>


<!-- 语法高亮 -->
<script type="text/javascript" src="/ue/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">SyntaxHighlighter.all();sync_count('vul');sync_count('news');sync_count('learning');sync_count('activity');sync_count('course');sync_count('ctf');</script>
    </div>

        <div class="footer">
        <div class="friend-link">
            <a href="http://www.360.cn/" target="_blank">360首页</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">关于我们</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">联系我们</a>
            <span>|</span>
            <a href="/links/index.html" target="_blank">友情链接</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">招贤纳士</a>
        </div>
        <div class="copy">
            Copyright &copy; 360网络攻防实验室 All Rights Reserved <span class="copy_icp">京ICP证080047号[京ICP备08010314号-6]</span>
        </div>
    </div>
    
</div>

<!--奇舞团统计-->

<script src='https://s.ssl.qhimg.com/static/f5407c785655e6a1/monitor_analytic.js'></script>
<script>
    monitor.setProject('QH_171_1').getTrack().getClickAndKeydown().getClickHeatmap(10, 1);
</script>

<div class="hide">
    <script src="https://s95.cnzz.com/z_stat.php?id=1253147824&web_id=1253147824" language="JavaScript"></script>
</div>
<div class="backToTop_wrap off">
    <a id="back_to_top" class="backToTop" href="javascript:;" title="返回顶部"></a>
</div>
<script>
    var $backToTop_wrap = $(".backToTop_wrap"),
        $backToTop_btn = $("#back_to_top");

    if ($(window).scrollTop() > 100) {
        $backToTop_wrap.removeClass("off");
    }
    else {
        $backToTop_wrap.addClass("off");
    }

    $(window).on("scroll", function () {
        if ($(this).scrollTop() > 100) {
            $backToTop_wrap.removeClass("off");
        }
        else {
            $backToTop_wrap.addClass("off");
        }
    });

    $backToTop_btn.on("click", function () {
        $("html, body").animate({scrollTop: 0}, 120);
    });

    $(function () {
        var navlist = $('.nav-list > li');

        navlist.each(function () {
            $(this).on('mouseenter', function () {
                $(this).addClass('selected');
            });

            $(this).on('mouseleave', function () {
                $(this).removeClass('selected');
            });
        });
    })
</script>



</body>
</html>
